var dependencyElements=new Array;var dependencyProperties=new Array;
function addDependency(property,elementName,dependencyProperty,keepDependentValue){var elements=dependencyElements[property];if(elements==null){elements=new Array;dependencyElements[property]=elements}elements[elements.length]=elementName;var properties=dependencyProperties[property];if(properties==null){properties=new Array;dependencyProperties[property]=properties}properties[properties.length]=dependencyProperty;var propertyElementName="propertyValue("+property+")";if(elementName.startsWith("childPropertyValue"))propertyElementName=
"childPropertyValue("+property+")";var element=document.forms[0].elements[propertyElementName];if(element)updateDependencies(property,element.value,keepDependentValue)}
function updateDependencies(property,value,keepDependentValue,extendedDataDictionaryOid,referenceTableOid,schoolOid,viewFieldPrefix){var relations=property.split(".");if(relations&&relations.length>0)property=relations[relations.length-1];var elements=dependencyElements[property];if(elements!=null)for(var i=0;i<elements.length;i++){var elementName=elements[i];var modelProperty=dependencyProperties[property][i];var element=document.forms[0].elements[elementName];if(element.type=="select-one"){var url=
"referenceDependencyUpdate.do?elementName="+elementName+"&modelProperty="+modelProperty+"&dependencyValue="+encodeParameter(value)+"&extendedDataDictionaryOid="+extendedDataDictionaryOid;makeSynchronousXmlRequest(url,"updateDependentSelect","void");lookupViewFields(elementName,referenceTableOid,schoolOid,viewFieldPrefix+elementName)}else if(element.type=="text"||element.type=="hidden")updateDependentPicklist(elementName,modelProperty,value,keepDependentValue)}}
function updateDependentPicklist(elementName,modelProperty,value,keepDependentValue){var picklistLink=document.getElementById("pllink_"+elementName);if(picklistLink)picklistLink.href=updateDependentPicklistFilter(picklistLink.href,value);var dynamicPicklistId=modelProperty+"&"+elementName;var dynamicPicklist=dynamicPickListById[dynamicPicklistId];if(dynamicPicklist)dynamicPicklist.pickListAttributes=updateDependentPicklistFilter(dynamicPicklist.pickListAttributes,value);if(keepDependentValue!="true")document.forms[0].elements[elementName].value=
""}function updateDependentPicklistFilter(picklistAttributes,value){var filterStr="rcdCodeDep!equals!and!constant!"+value;if(value===undefined||value===null||value==="")filterStr="rcdCodeDep!equals!and!constant!null";if(picklistAttributes.indexOf("rcdCodeDep")<0)return picklistAttributes.replace(/filters=/,"filters="+filterStr+",");return picklistAttributes.replace(/rcdCodeDep!equals!and!constant!.*?&/,filterStr+"&")}
function updateDependentSelect(replyXml){var root=replyXml.getElementsByTagName("r")[0];var elementName=root.getAttribute("id");var element=document.forms[0].elements[elementName];var currentSelection=element.options[element.selectedIndex].value;var newCodes=root.getElementsByTagName("c");if(newCodes.length>0){var options=new Array;element.length=newCodes.length;for(var i=0;i<newCodes.length;i++){var newCode=newCodes[i].getAttribute("v");var option=new Option(newCode,newCode);if(currentSelection==
newCode)option.selected=true;element.options[i]=option}}};